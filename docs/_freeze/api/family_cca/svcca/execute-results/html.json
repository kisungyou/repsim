{
  "hash": "90f3d0438ace37a0e50453979b926adf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"svcca\"\ndisplaytitle: \"Singular Vector Canonical Correlation Analysis\"\ncategories: [\"CCA\"]\nsidebar: api\nformat:\n  html:\n    toc: true\n    toc-location: right\n    include-after-body:\n      - ../custom-title.html\nbibliography: ../REFERENCES.bib\nlink-citations: true\n---\n\n\n\n\n### Description \n\nCompute pairwise singular vector CCA (SVCCA) similarities between multiple representations [@raghu_2017_SVCCASingularVector]. \nSVCCA first mean-centers and denoises each representation via SVD, \nretaining components explaining a high fraction of variance at 99% threshold. Then, \nCCA is applied to the reduced representations, and the similarity is summarized \nwith either Yanai’s GCD [@ramsay_1984_MatrixCorrelation] or Pillai’s trace [@raghu_2017_SVCCASingularVector].\n\n\n### Usage\n\n::: {.panel-tabset group=\"language\"}\n## Python\n\n`repsim.svcca(mats, summary_type = None)`\n\n\n## R {.active}\n\n`svcca(mats, summary_type = NULL)`\n:::\n\n### Arguments\n\n::: {.panel-tabset group=\"language\"}\n## Python\n- **mats**: sequence of array-like, length $M$\n        List or tuple of `M` data representations, each of shape ``(n_samples, n_features_k)``.\n        All matrices must share the same number of rows for matching samples.\n        Each element can be a NumPy array or any object convertible to one via\n        ``numpy.asarray``.\n- **summary_type**: str, optional\n        Summary statistic for canonical correlations. One of ``\"yanai\"`` and ``\"pillai\"``.\n        Defaults to ``\"yanai\"``.\n\n## R {.active}\n- **mats**: A list of length `M` containing data matrices of size \n    `(n_samples, n_features_k)`. All matrices must share the same number\n    of rows for matching samples.\n- **summary_type**:  Character scalar indicating the CCA summary statistic. \n    One of `\"yanai\"` or `\"pillai\"`. Defaults to `\"yanai\"` if `NULL`.\n:::\n\n### Returns\n\n::: {.panel-tabset group=\"language\"}\n## Python\n\n`numpy.ndarray`\n: Array of shape `(M, M)` of SVCCA summary similarities.\n\n## R {.active}\n\n`matrix`\n: An `(M, M)` symmetric matrix of SVCCA summary similarities.\n:::\n\n### Examples\n\n::: {.panel-tabset group=\"language\"}\n\n## Python\n\n::: {.cell}\n\n```{.python .cell-code}\n# load necessary packages\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.datasets import load_iris\nfrom sklearn.preprocessing import StandardScaler\nimport repsim\n\n# set a random seed\nnp.random.seed(1)\n\n# prepare the prototype\niris = load_iris(as_frame=True).frame.iloc[:, :4]\nurl = \"https://vincentarelbundock.github.io/Rdatasets/csv/datasets/USArrests.csv\"\nusarrests = pd.read_csv(url, index_col=0)\n\nX = StandardScaler().fit_transform(iris.sample(50, random_state=1))\nY = StandardScaler().fit_transform(usarrests)\n\nn, p_X, p_Y = X.shape[0], X.shape[1], Y.shape[1]\n\n# generate 10 of each by perturbation\nmats = []\nfor _ in range(10):\n    mats.append(X + np.random.normal(scale=1.0, size=(n, p_X)))\nfor _ in range(10):\n    mats.append(Y + np.random.normal(scale=1.0, size=(n, p_Y)))\n\n# compute similarities\nsvcca_gcd = repsim.svcca(mats, summary_type=\"yanai\")\nsvcca_trace = repsim.svcca(mats, summary_type=\"pillai\")\n\n# visualize: two heatmaps side by side\nfig, axes = plt.subplots(1, 2, figsize=(8, 4), constrained_layout=True)\ntitles = [\"SVCCA: Yanai's GCD\", \"SVCCA: Pillai's Trace\"]\nmats_show = [svcca_gcd, svcca_trace]\n\nlabs = [f\"rep {i}\" for i in range(1, 21)]\neven_idx = list(range(1, 20, 2))\n\nfor ax, mat, title in zip(axes, mats_show, titles):\n    im = ax.imshow(mat, origin=\"upper\")\n    ax.set_title(title)\n    _ = ax.set_xticks(even_idx)\n    _ = ax.set_xticklabels([labs[i] for i in even_idx], rotation=90)\n    _ = ax.set_yticks(even_idx)\n    _ = ax.set_yticklabels([labs[i] for i in even_idx])\n\nplt.show()\n```\n\n::: {.cell-output-display}\n![](svcca_files/figure-html/unnamed-chunk-2-1.png){width=768}\n:::\n:::\n\n\n## R {.active}\n\n::: {.cell}\n\n```{.r .cell-code}\n# load necessary packages\nlibrary(repsim)\n\n# set a random seed\nset.seed(1)\n\n# prepare the prototype\nX <- as.matrix(scale(as.matrix(iris[sample(1:150, 50, replace = FALSE), 1:4])))\nY <- as.matrix(scale(as.matrix(USArrests)))\nn   <- nrow(X)\np_X <- ncol(X)\np_Y <- ncol(Y)\n\n# generate 10 of each by perturbation\nmats <- vector(\"list\", length = 20L)\nfor (i in 1:10){\n  mats[[i]] <- X + matrix(rnorm(n * p_X, sd = 1), nrow = n)\n}\nfor (j in 11:20){\n  mats[[j]] <- Y + matrix(rnorm(n * p_Y, sd = 1), nrow = n)\n}\n\n# compute similarities\nsvcca_gcd   <- svcca(mats, summary_type = \"yanai\")\nsvcca_trace <- svcca(mats, summary_type = \"pillai\")\n\n# visualize: two heatmaps side by side\nlabs <- paste0(\"rep \", 1:20)\npar(pty = \"s\", mfrow = c(1, 2))\n\nimage(svcca_gcd[, 20:1], axes = FALSE, main = \"SVCCA: Yanai's GCD\")\naxis(1, seq(0, 1, length.out = 20), labels = labs, las = 2)\naxis(2, at = seq(0, 1, length.out = 20), labels = rev(labs), las = 2)\n\nimage(svcca_trace[, 20:1], axes = FALSE, main = \"SVCCA: Pillai's Trace\")\naxis(1, seq(0, 1, length.out = 20), labels = labs, las = 2)\naxis(2, at = seq(0, 1, length.out = 20), labels = rev(labs), las = 2)\n```\n\n::: {.cell-output-display}\n![](svcca_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n:::\n\n:::\n\n\n### References\n::: {#refs}\n:::",
    "supporting": [
      "svcca_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}